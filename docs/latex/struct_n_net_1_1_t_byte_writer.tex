\doxysection{NNet\+::TByte\+Writer\texorpdfstring{$<$}{<} TSocket \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{struct_n_net_1_1_t_byte_writer}{}\label{struct_n_net_1_1_t_byte_writer}\index{NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}}


A utility for writing data to a socket-\/like object.  




{\ttfamily \#include $<$sockutils.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{struct_n_net_1_1_t_byte_writer_a5d0ccd2ed16ef6c4d0fa5bccbb8b113e}{TByte\+Writer}} (\mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} \&socket)
\begin{DoxyCompactList}\small\item\em Constructs a writer for the given socket. \end{DoxyCompactList}\item 
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ void $>$ \mbox{\hyperlink{struct_n_net_1_1_t_byte_writer_acc8363d16f9b540439d7e9c95185ecae}{Write}} (const void \texorpdfstring{$\ast$}{*}data, size\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Writes exactly {\ttfamily size} bytes from {\ttfamily data} to the socket. \end{DoxyCompactList}\item 
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ void $>$ \mbox{\hyperlink{struct_n_net_1_1_t_byte_writer_a1f907d3c1d0856578f11af55f1d12360}{Write}} (const \mbox{\hyperlink{struct_n_net_1_1_t_line}{TLine}} \&line)
\begin{DoxyCompactList}\small\item\em Writes a {\ttfamily \doxylink{struct_n_net_1_1_t_line}{TLine}} object by sequentially writing its parts. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$\newline
class NNet\+::\+TByte\+Writer$<$ TSocket $>$}
A utility for writing data to a socket-\/like object. 

This class provides methods to write a specified number of bytes or to write a {\ttfamily \doxylink{struct_n_net_1_1_t_line}{TLine}} object. If the underlying socket indicates it cannot make progress, the write operation is retried; if the socket is closed (write returns 0), an exception is thrown.


\begin{DoxyTemplParams}{Template Parameters}
{\em \doxylink{class_n_net_1_1_t_socket}{TSocket}} & The socket type used for writing bytes. It must provide a method {\ttfamily TValue\+Task$<$ssize\+\_\+t$>$ Write\+Some(const void\texorpdfstring{$\ast$}{*} data, size\+\_\+t size)} which returns\+:
\begin{DoxyItemize}
\item 0 if the connection is closed,
\item a positive number for the count of bytes successfully written,
\item a negative number to indicate a recoverable write error (in which case a retry may be attempted).
\end{DoxyItemize}\\
\hline
\end{DoxyTemplParams}
\hypertarget{struct_n_net_1_1_t_byte_writer_autotoc_md4}{}\doxysubsubsubsection{\texorpdfstring{Example Usage}{Example Usage}}\label{struct_n_net_1_1_t_byte_writer_autotoc_md4}

\begin{DoxyCode}{0}
\DoxyCodeLine{TValueTask<void>\ ExampleFunction(TSocket\&\ socket)\ \{}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{struct_n_net_1_1_t_byte_writer_a5d0ccd2ed16ef6c4d0fa5bccbb8b113e}{TByteWriter<TSocket>}}\ writer(socket);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Write\ a\ fixed\ amount\ of\ data}}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message\ =\ \textcolor{stringliteral}{"{}Hello,\ World!"{}};}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{co\_await}\ writer.Write(message,\ std::strlen(message));}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Write\ a\ TLine\ object}}
\DoxyCodeLine{\ \ \ \ TLine\ line\{\textcolor{stringliteral}{"{}PartA"{}},\ \textcolor{stringliteral}{"{}PartB"{}}\};}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{co\_await}\ writer.Write(line);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{co\_return};}
\DoxyCodeLine{\}}

\end{DoxyCode}
 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{struct_n_net_1_1_t_byte_writer_a5d0ccd2ed16ef6c4d0fa5bccbb8b113e}\index{NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}!TByteWriter@{TByteWriter}}
\index{TByteWriter@{TByteWriter}!NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}}
\doxysubsubsection{\texorpdfstring{TByteWriter()}{TByteWriter()}}
{\footnotesize\ttfamily \label{struct_n_net_1_1_t_byte_writer_a5d0ccd2ed16ef6c4d0fa5bccbb8b113e} 
template$<$typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$ \\
\mbox{\hyperlink{struct_n_net_1_1_t_byte_writer}{NNet\+::\+TByte\+Writer}}$<$ \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} $>$\+::\+TByte\+Writer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} \&}]{socket}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructs a writer for the given socket. 


\begin{DoxyParams}{Parameters}
{\em socket} & Reference to a socket-\/like object used for writing. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{struct_n_net_1_1_t_byte_writer_a1f907d3c1d0856578f11af55f1d12360}\index{NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}!Write@{Write}}
\index{Write@{Write}!NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}}
\doxysubsubsection{\texorpdfstring{Write()}{Write()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{struct_n_net_1_1_t_byte_writer_a1f907d3c1d0856578f11af55f1d12360} 
template$<$typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$ \\
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ void $>$ \mbox{\hyperlink{struct_n_net_1_1_t_byte_writer}{NNet\+::\+TByte\+Writer}}$<$ \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} $>$\+::\+Write (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_n_net_1_1_t_line}{TLine}} \&}]{line}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Writes a {\ttfamily \doxylink{struct_n_net_1_1_t_line}{TLine}} object by sequentially writing its parts. 

This method calls \doxylink{struct_n_net_1_1_t_byte_writer_acc8363d16f9b540439d7e9c95185ecae}{Write(const void\texorpdfstring{$\ast$}{*}, size\+\_\+t)} for {\ttfamily line.\+Part1} and then {\ttfamily line.\+Part2}.


\begin{DoxyParams}{Parameters}
{\em line} & A structure holding the data to write in two parts.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A TValue\+Task$<$void$>$ that completes once both parts have been fully written.
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::runtime\+\_\+error} & If the connection is closed while writing. \\
\hline
\end{DoxyExceptions}
\Hypertarget{struct_n_net_1_1_t_byte_writer_acc8363d16f9b540439d7e9c95185ecae}\index{NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}!Write@{Write}}
\index{Write@{Write}!NNet::TByteWriter$<$ TSocket $>$@{NNet::TByteWriter$<$ TSocket $>$}}
\doxysubsubsection{\texorpdfstring{Write()}{Write()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{struct_n_net_1_1_t_byte_writer_acc8363d16f9b540439d7e9c95185ecae} 
template$<$typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$ \\
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ void $>$ \mbox{\hyperlink{struct_n_net_1_1_t_byte_writer}{NNet\+::\+TByte\+Writer}}$<$ \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} $>$\+::\+Write (\begin{DoxyParamCaption}\item[{const void \texorpdfstring{$\ast$}{*}}]{data}{, }\item[{size\+\_\+t}]{size}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Writes exactly {\ttfamily size} bytes from {\ttfamily data} to the socket. 


\begin{DoxyItemize}
\item Calls the socket\textquotesingle{}s Write\+Some() in a loop until all requested bytes are written.
\item If Write\+Some() returns 0, a std\+::runtime\+\_\+error is thrown to indicate closure.
\item If Write\+Some() returns a negative value, the write is retried.
\end{DoxyItemize}


\begin{DoxyParams}{Parameters}
{\em data} & Pointer to the buffer containing the bytes to write. \\
\hline
{\em size} & The number of bytes to write.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A TValue\+Task$<$void$>$ that completes when all bytes have been written or an exception is thrown if the socket is closed.
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::runtime\+\_\+error} & If the connection is closed before {\ttfamily size} bytes are fully written. \\
\hline
\end{DoxyExceptions}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
coroio/sockutils.\+hpp\end{DoxyCompactItemize}
