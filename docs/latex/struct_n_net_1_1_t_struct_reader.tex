\doxysection{NNet\+::TStruct\+Reader\texorpdfstring{$<$}{<} T, TSocket \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{struct_n_net_1_1_t_struct_reader}{}\label{struct_n_net_1_1_t_struct_reader}\index{NNet::TStructReader$<$ T, TSocket $>$@{NNet::TStructReader$<$ T, TSocket $>$}}


A utility for reading a fixed-\/size structure of type {\ttfamily T} from a socket-\/like object.  




{\ttfamily \#include $<$sockutils.\+hpp$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{struct_n_net_1_1_t_struct_reader_a01aed1fb8dc52c06e5177b13b02c0f3a}{TStruct\+Reader}} (\mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} \&socket)
\begin{DoxyCompactList}\small\item\em Constructs a reader with a reference to the given socket. \end{DoxyCompactList}\item 
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ T $>$ \mbox{\hyperlink{struct_n_net_1_1_t_struct_reader_ab01ad1a8c37cc594376b468201382ef0}{Read}} ()
\begin{DoxyCompactList}\small\item\em Reads a single instance of type {\ttfamily T} from the socket. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename T, typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$\newline
class NNet\+::\+TStruct\+Reader$<$ T, TSocket $>$}
A utility for reading a fixed-\/size structure of type {\ttfamily T} from a socket-\/like object. 

This class expects the socket to provide a method {\ttfamily TValue\+Task$<$ssize\+\_\+t$>$ Read\+Some(void\texorpdfstring{$\ast$}{*} buffer, size\+\_\+t size)}, which returns\+:
\begin{DoxyItemize}
\item 0 if the connection is closed,
\item a positive number for the count of bytes successfully read,
\item a negative number to indicate a recoverable read error (in which case a retry may be attempted).
\end{DoxyItemize}


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & A trivially copyable (or otherwise byte-\/serializable) type that can be read directly into memory. \\
\hline
{\em \doxylink{class_n_net_1_1_t_socket}{TSocket}} & The socket type used for reading, offering the required {\ttfamily Read\+Some()} method.\\
\hline
\end{DoxyTemplParams}
\hypertarget{struct_n_net_1_1_t_struct_reader_autotoc_md5}{}\doxysubsubsubsection{\texorpdfstring{Example Usage}{Example Usage}}\label{struct_n_net_1_1_t_struct_reader_autotoc_md5}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{//\ A\ simple\ struct\ to\ demonstrate\ reading\ a\ fixed-\/size\ block\ of\ data:}}
\DoxyCodeLine{\textcolor{keyword}{struct\ }MyData\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{int}\ Id;}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordtype}{float}\ Value;}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{TValueTask<void>\ ExampleFunction(TSocket\&\ socket)\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Create\ a\ reader\ for\ MyData\ structures}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{struct_n_net_1_1_t_struct_reader_a01aed1fb8dc52c06e5177b13b02c0f3a}{TStructReader<MyData,\ TSocket>}}\ reader(socket);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ Read\ one\ instance\ of\ MyData}}
\DoxyCodeLine{\ \ \ \ MyData\ data\ =\ \textcolor{keyword}{co\_await}\ reader.Read();}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ 'data'\ is\ now\ populated\ with\ the\ bytes\ read\ from\ the\ socket}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ (assuming\ the\ full\ size\ of\ MyData\ was\ successfully\ read).}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \textcolor{keyword}{co\_return};}
\DoxyCodeLine{\}}

\end{DoxyCode}
 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{struct_n_net_1_1_t_struct_reader_a01aed1fb8dc52c06e5177b13b02c0f3a}\index{NNet::TStructReader$<$ T, TSocket $>$@{NNet::TStructReader$<$ T, TSocket $>$}!TStructReader@{TStructReader}}
\index{TStructReader@{TStructReader}!NNet::TStructReader$<$ T, TSocket $>$@{NNet::TStructReader$<$ T, TSocket $>$}}
\doxysubsubsection{\texorpdfstring{TStructReader()}{TStructReader()}}
{\footnotesize\ttfamily \label{struct_n_net_1_1_t_struct_reader_a01aed1fb8dc52c06e5177b13b02c0f3a} 
template$<$typename T, typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$ \\
\mbox{\hyperlink{struct_n_net_1_1_t_struct_reader}{NNet\+::\+TStruct\+Reader}}$<$ T, \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} $>$\+::\+TStruct\+Reader (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} \&}]{socket}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructs a reader with a reference to the given socket. 


\begin{DoxyParams}{Parameters}
{\em socket} & Reference to a socket-\/like object used for reading data. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{struct_n_net_1_1_t_struct_reader_ab01ad1a8c37cc594376b468201382ef0}\index{NNet::TStructReader$<$ T, TSocket $>$@{NNet::TStructReader$<$ T, TSocket $>$}!Read@{Read}}
\index{Read@{Read}!NNet::TStructReader$<$ T, TSocket $>$@{NNet::TStructReader$<$ T, TSocket $>$}}
\doxysubsubsection{\texorpdfstring{Read()}{Read()}}
{\footnotesize\ttfamily \label{struct_n_net_1_1_t_struct_reader_ab01ad1a8c37cc594376b468201382ef0} 
template$<$typename T, typename \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}}$>$ \\
\mbox{\hyperlink{struct_n_net_1_1_t_future}{TFuture}}$<$ T $>$ \mbox{\hyperlink{struct_n_net_1_1_t_struct_reader}{NNet\+::\+TStruct\+Reader}}$<$ T, \mbox{\hyperlink{class_n_net_1_1_t_socket}{TSocket}} $>$\+::\+Read (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Reads a single instance of type {\ttfamily T} from the socket. 


\begin{DoxyItemize}
\item Reads exactly {\ttfamily sizeof(\+T)} bytes.
\item Continues to call {\ttfamily Read\+Some()} until all needed bytes are read.
\item Throws a {\ttfamily std\+::runtime\+\_\+error} if the socket closes (returns 0) before the structure is fully read.
\item Retries if {\ttfamily Read\+Some()} returns a negative number (indicating a recoverable read error).
\end{DoxyItemize}

\begin{DoxyReturn}{Returns}
A TValue\+Task$<$\+T$>$ that completes once the entire structure is read.
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::runtime\+\_\+error} & If the connection is closed before the structure is fully read. \\
\hline
\end{DoxyExceptions}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
coroio/sockutils.\+hpp\end{DoxyCompactItemize}
